!function(m){"use strict";var e="countdown";m.JQPlugin.createPlugin({name:e,defaultOptions:{until:null,since:null,timezone:null,serverSync:null,format:"dHMS",layout:"",compact:!1,padZeroes:!1,significant:0,description:"",expiryUrl:"",expiryText:"",alwaysExpire:!1,onExpiry:null,onTick:null,tickInterval:1},regionalOptions:{"":{labels:["Years","Months","Weeks","Days","Hours","Minutes","Seconds"],labels1:["Year","Month","Week","Day","Hour","Minute","Second"],compactLabels:["y","m","w","d"],whichLabels:null,digits:["0","1","2","3","4","5","6","7","8","9"],timeSeparator:":",isRTL:!1}},_rtlClass:e+"-rtl",_sectionClass:e+"-section",_amountClass:e+"-amount",_periodClass:e+"-period",_rowClass:e+"-row",_holdingClass:e+"-holding",_showClass:e+"-show",_descrClass:e+"-descr",_timerElems:[],_init:function(){var s=this;this._super(),this._serverSyncs=[];var n="function"==typeof Date.now?Date.now:function(){return(new Date).getTime()},o=window.performance&&"function"==typeof window.performance.now,r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null,a=0;!r||m.noRequestAnimationFrame?(m.noRequestAnimationFrame=null,m.countdown._timer=setInterval(function(){s._updateElems()},1e3)):(a=window.animationStartTime||window.webkitAnimationStartTime||window.mozAnimationStartTime||window.oAnimationStartTime||window.msAnimationStartTime||n(),r(function e(i){var t=i<1e12?o?window.performance.now()+window.performance.timing.navigationStart:n():i||n();1e3<=t-a&&(s._updateElems(),a=t),r(e)}))},UTCDate:function(e,i,t,s,n,o,r,a){"object"==typeof i&&i instanceof Date&&(a=i.getMilliseconds(),r=i.getSeconds(),o=i.getMinutes(),n=i.getHours(),s=i.getDate(),t=i.getMonth(),i=i.getFullYear());var l=new Date;return l.setUTCFullYear(i),l.setUTCDate(1),l.setUTCMonth(t||0),l.setUTCDate(s||1),l.setUTCHours(n||0),l.setUTCMinutes((o||0)-(Math.abs(e)<30?60*e:e)),l.setUTCSeconds(r||0),l.setUTCMilliseconds(a||0),l},periodsToSeconds:function(e){return 31557600*e[0]+2629800*e[1]+604800*e[2]+86400*e[3]+3600*e[4]+60*e[5]+e[6]},resync:function(){var n=this;m("."+this._getMarker()).each(function(){var e=m.data(this,n.name);if(e.options.serverSync){for(var i=null,t=0;t<n._serverSyncs.length;t++)if(n._serverSyncs[t][0]===e.options.serverSync){i=n._serverSyncs[t];break}if(n._eqNull(i[2])){var s=m.isFunction(e.options.serverSync)?e.options.serverSync.apply(this,[]):null;i[2]=(s?(new Date).getTime()-s.getTime():0)-i[1]}e._since&&e._since.setMilliseconds(e._since.getMilliseconds()+i[2]),e._until.setMilliseconds(e._until.getMilliseconds()+i[2])}});for(var e=0;e<n._serverSyncs.length;e++)n._eqNull(n._serverSyncs[e][2])||(n._serverSyncs[e][1]+=n._serverSyncs[e][2],delete n._serverSyncs[e][2])},_instSettings:function(e,i){return{_periods:[0,0,0,0,0,0,0]}},_addElem:function(e){this._hasElem(e)||this._timerElems.push(e)},_hasElem:function(e){return-1<m.inArray(e,this._timerElems)},_removeElem:function(i){this._timerElems=m.map(this._timerElems,function(e){return e===i?null:e})},_updateElems:function(){for(var e=this._timerElems.length-1;0<=e;e--)this._updateCountdown(this._timerElems[e])},_optionsChanged:function(e,i,t){t.layout&&(t.layout=t.layout.replace(/&lt;/g,"<").replace(/&gt;/g,">")),this._resetExtraLabels(i.options,t);var s=i.options.timezone!==t.timezone;m.extend(i.options,t),this._adjustSettings(e,i,!this._eqNull(t.until)||!this._eqNull(t.since)||s);var n=new Date;(i._since&&i._since<n||i._until&&i._until>n)&&this._addElem(e[0]),this._updateCountdown(e,i)},_updateCountdown:function(e,i){if(e=e.jquery?e:m(e),i=i||this._getInst(e)){if(e.html(this._generateHTML(i)).toggleClass(this._rtlClass,i.options.isRTL),"pause"!==i._hold&&m.isFunction(i.options.onTick)){var t="lap"!==i._hold?i._periods:this._calculatePeriods(i,i._show,i.options.significant,new Date);1!==i.options.tickInterval&&this.periodsToSeconds(t)%i.options.tickInterval!=0||i.options.onTick.apply(e[0],[t])}if("pause"!==i._hold&&(i._since?i._now.getTime()<i._since.getTime():i._now.getTime()>=i._until.getTime())&&!i._expiring){if(i._expiring=!0,this._hasElem(e[0])||i.options.alwaysExpire){if(this._removeElem(e[0]),m.isFunction(i.options.onExpiry)&&i.options.onExpiry.apply(e[0],[]),i.options.expiryText){var s=i.options.layout;i.options.layout=i.options.expiryText,this._updateCountdown(e[0],i),i.options.layout=s}i.options.expiryUrl&&(window.location=i.options.expiryUrl)}i._expiring=!1}else"pause"===i._hold&&this._removeElem(e[0])}},_resetExtraLabels:function(e,i){var t=null;for(t in i)t.match(/[Ll]abels[02-9]|compactLabels1/)&&(e[t]=i[t]);for(t in e)t.match(/[Ll]abels[02-9]|compactLabels1/)&&void 0===i[t]&&(e[t]=null)},_eqNull:function(e){return null==e},_adjustSettings:function(e,i,t){for(var s=null,n=0;n<this._serverSyncs.length;n++)if(this._serverSyncs[n][0]===i.options.serverSync){s=this._serverSyncs[n][1];break}var o=null,r=null;if(this._eqNull(s)){var a=m.isFunction(i.options.serverSync)?i.options.serverSync.apply(e[0],[]):null;o=new Date,r=a?o.getTime()-a.getTime():0,this._serverSyncs.push([i.options.serverSync,r])}else o=new Date,r=i.options.serverSync?s:0;var l=i.options.timezone;l=this._eqNull(l)?-o.getTimezoneOffset():l,(t||!t&&this._eqNull(i._until)&&this._eqNull(i._since))&&(i._since=i.options.since,this._eqNull(i._since)||(i._since=this.UTCDate(l,this._determineTime(i._since,null)),i._since&&r&&i._since.setMilliseconds(i._since.getMilliseconds()+r)),i._until=this.UTCDate(l,this._determineTime(i.options.until,o)),r&&i._until.setMilliseconds(i._until.getMilliseconds()+r)),i._show=this._determineShow(i)},_preDestroy:function(e,i){this._removeElem(e[0]),e.empty()},pause:function(e){this._hold(e,"pause")},lap:function(e){this._hold(e,"lap")},resume:function(e){this._hold(e,null)},toggle:function(e){this[(m.data(e,this.name)||{})._hold?"resume":"pause"](e)},toggleLap:function(e){this[(m.data(e,this.name)||{})._hold?"resume":"lap"](e)},_hold:function(e,i){var t=m.data(e,this.name);if(t){if("pause"===t._hold&&!i){t._periods=t._savePeriods;var s=t._since?"-":"+";t[t._since?"_since":"_until"]=this._determineTime(s+t._periods[0]+"y"+s+t._periods[1]+"o"+s+t._periods[2]+"w"+s+t._periods[3]+"d"+s+t._periods[4]+"h"+s+t._periods[5]+"m"+s+t._periods[6]+"s"),this._addElem(e)}t._hold=i,t._savePeriods="pause"===i?t._periods:null,m.data(e,this.name,t),this._updateCountdown(e,t)}},getTimes:function(e){var i=m.data(e,this.name);return i?"pause"===i._hold?i._savePeriods:i._hold?this._calculatePeriods(i,i._show,i.options.significant,new Date):i._periods:null},_determineTime:function(e,i){var t,s,p=this,n=this._eqNull(e)?i:"string"==typeof e?function(e){e=e.toLowerCase();for(var i=new Date,t=i.getFullYear(),s=i.getMonth(),n=i.getDate(),o=i.getHours(),r=i.getMinutes(),a=i.getSeconds(),l=/([+-]?[0-9]+)\s*(s|m|h|d|w|o|y)?/g,_=l.exec(e);_;){switch(_[2]||"s"){case"s":a+=parseInt(_[1],10);break;case"m":r+=parseInt(_[1],10);break;case"h":o+=parseInt(_[1],10);break;case"d":n+=parseInt(_[1],10);break;case"w":n+=7*parseInt(_[1],10);break;case"o":s+=parseInt(_[1],10),n=Math.min(n,p._getDaysInMonth(t,s));break;case"y":t+=parseInt(_[1],10),n=Math.min(n,p._getDaysInMonth(t,s))}_=l.exec(e)}return new Date(t,s,n,o,r,a,0)}(e):"number"==typeof e?(t=e,(s=new Date).setTime(s.getTime()+1e3*t),s):e;return n&&n.setMilliseconds(0),n},_getDaysInMonth:function(e,i){return 32-new Date(e,i,32).getDate()},_normalLabels:function(e){return e},_generateHTML:function(t){var s=this;t._periods=t._hold?t._periods:this._calculatePeriods(t,t._show,t.options.significant,new Date);var e=!1,i=0,n=t.options.significant,o=m.extend({},t._show),r=null;for(r=0;r<=6;r++)e=e||"?"===t._show[r]&&0<t._periods[r],o[r]="?"!==t._show[r]||e?t._show[r]:null,i+=o[r]?1:0,n-=0<t._periods[r]?1:0;var a=[!1,!1,!1,!1,!1,!1,!1];for(r=6;0<=r;r--)t._show[r]&&(t._periods[r]?a[r]=!0:(a[r]=0<n,n--));var l=t.options.compact?t.options.compactLabels:t.options.labels,_=t.options.whichLabels||this._normalLabels,p=function(e){var i=t.options["compactLabels"+_(t._periods[e])];return o[e]?s._translateDigits(t,t._periods[e])+(i?i[e]:l[e])+" ":""},c=t.options.padZeroes?2:1,u=function(e){var i=t.options["labels"+_(t._periods[e])];return!t.options.significant&&o[e]||t.options.significant&&a[e]?'<span class="'+s._sectionClass+'"><span class="'+s._amountClass+'">'+s._minDigits(t,t._periods[e],c)+'</span><span class="'+s._periodClass+'">'+(i?i[e]:l[e])+"</span></span>":""};return t.options.layout?this._buildLayout(t,o,t.options.layout,t.options.compact,t.options.significant,a):(t.options.compact?'<span class="'+this._rowClass+" "+this._amountClass+(t._hold?" "+this._holdingClass:"")+'">'+p(0)+p(1)+p(2)+p(3)+(o[4]?this._minDigits(t,t._periods[4],2):"")+(o[5]?(o[4]?t.options.timeSeparator:"")+this._minDigits(t,t._periods[5],2):"")+(o[6]?(o[4]||o[5]?t.options.timeSeparator:"")+this._minDigits(t,t._periods[6],2):""):'<span class="'+this._rowClass+" "+this._showClass+(t.options.significant||i)+(t._hold?" "+this._holdingClass:"")+'">'+u(0)+u(1)+u(2)+u(3)+u(4)+u(5)+u(6))+"</span>"+(t.options.description?'<span class="'+this._rowClass+" "+this._descrClass+'">'+t.options.description+"</span>":"")},_buildLayout:function(t,e,i,s,n,o){for(var r=t.options[s?"compactLabels":"labels"],a=t.options.whichLabels||this._normalLabels,l=function(e){return(t.options[(s?"compactLabels":"labels")+a(t._periods[e])]||r)[e]},_=function(e,i){return t.options.digits[Math.floor(e/i)%10]},p={desc:t.options.description,sep:t.options.timeSeparator,yl:l(0),yn:this._minDigits(t,t._periods[0],1),ynn:this._minDigits(t,t._periods[0],2),ynnn:this._minDigits(t,t._periods[0],3),y1:_(t._periods[0],1),y10:_(t._periods[0],10),y100:_(t._periods[0],100),y1000:_(t._periods[0],1e3),ol:l(1),on:this._minDigits(t,t._periods[1],1),onn:this._minDigits(t,t._periods[1],2),onnn:this._minDigits(t,t._periods[1],3),o1:_(t._periods[1],1),o10:_(t._periods[1],10),o100:_(t._periods[1],100),o1000:_(t._periods[1],1e3),wl:l(2),wn:this._minDigits(t,t._periods[2],1),wnn:this._minDigits(t,t._periods[2],2),wnnn:this._minDigits(t,t._periods[2],3),w1:_(t._periods[2],1),w10:_(t._periods[2],10),w100:_(t._periods[2],100),w1000:_(t._periods[2],1e3),dl:l(3),dn:this._minDigits(t,t._periods[3],1),dnn:this._minDigits(t,t._periods[3],2),dnnn:this._minDigits(t,t._periods[3],3),d1:_(t._periods[3],1),d10:_(t._periods[3],10),d100:_(t._periods[3],100),d1000:_(t._periods[3],1e3),hl:l(4),hn:this._minDigits(t,t._periods[4],1),hnn:this._minDigits(t,t._periods[4],2),hnnn:this._minDigits(t,t._periods[4],3),h1:_(t._periods[4],1),h10:_(t._periods[4],10),h100:_(t._periods[4],100),h1000:_(t._periods[4],1e3),ml:l(5),mn:this._minDigits(t,t._periods[5],1),mnn:this._minDigits(t,t._periods[5],2),mnnn:this._minDigits(t,t._periods[5],3),m1:_(t._periods[5],1),m10:_(t._periods[5],10),m100:_(t._periods[5],100),m1000:_(t._periods[5],1e3),sl:l(6),sn:this._minDigits(t,t._periods[6],1),snn:this._minDigits(t,t._periods[6],2),snnn:this._minDigits(t,t._periods[6],3),s1:_(t._periods[6],1),s10:_(t._periods[6],10),s100:_(t._periods[6],100),s1000:_(t._periods[6],1e3)},c=i,u=0;u<=6;u++){var h="yowdhms".charAt(u),d=new RegExp("\\{"+h+"<\\}([\\s\\S]*)\\{"+h+">\\}","g");c=c.replace(d,!n&&e[u]||n&&o[u]?"$1":"")}return m.each(p,function(e,i){var t=new RegExp("\\{"+e+"\\}","g");c=c.replace(t,i)}),c},_minDigits:function(e,i,t){return(i=""+i).length>=t?this._translateDigits(e,i):(i="0000000000"+i,this._translateDigits(e,i.substr(i.length-t)))},_translateDigits:function(i,e){return(""+e).replace(/[0-9]/g,function(e){return i.options.digits[e]})},_determineShow:function(e){var i=e.options.format,t=[];return t[0]=i.match("y")?"?":i.match("Y")?"!":null,t[1]=i.match("o")?"?":i.match("O")?"!":null,t[2]=i.match("w")?"?":i.match("W")?"!":null,t[3]=i.match("d")?"?":i.match("D")?"!":null,t[4]=i.match("h")?"?":i.match("H")?"!":null,t[5]=i.match("m")?"?":i.match("M")?"!":null,t[6]=i.match("s")?"?":i.match("S")?"!":null,t},_calculatePeriods:function(e,t,i,s){e._now=s,e._now.setMilliseconds(0);var n=new Date(e._now.getTime());e._since?s.getTime()<e._since.getTime()?e._now=s=n:s=e._since:(n.setTime(e._until.getTime()),s.getTime()>e._until.getTime()&&(e._now=s=n));var o=[0,0,0,0,0,0,0];if(t[0]||t[1]){var r=this._getDaysInMonth(s.getFullYear(),s.getMonth()),a=this._getDaysInMonth(n.getFullYear(),n.getMonth()),l=n.getDate()===s.getDate()||n.getDate()>=Math.min(r,a)&&s.getDate()>=Math.min(r,a),_=function(e){return 60*(60*e.getHours()+e.getMinutes())+e.getSeconds()},p=Math.max(0,12*(n.getFullYear()-s.getFullYear())+n.getMonth()-s.getMonth()+(n.getDate()<s.getDate()&&!l||l&&_(n)<_(s)?-1:0));o[0]=t[0]?Math.floor(p/12):0,o[1]=t[1]?p-12*o[0]:0;var c=(s=new Date(s.getTime())).getDate()===r,u=this._getDaysInMonth(s.getFullYear()+o[0],s.getMonth()+o[1]);s.getDate()>u&&s.setDate(u),s.setFullYear(s.getFullYear()+o[0]),s.setMonth(s.getMonth()+o[1]),c&&s.setDate(u)}var h=Math.floor((n.getTime()-s.getTime())/1e3),d=null,m=function(e,i){o[e]=t[e]?Math.floor(h/i):0,h-=o[e]*i};if(m(2,604800),m(3,86400),m(4,3600),m(5,60),m(6,1),0<h&&!e._since){var g=[1,12,4.3482,7,24,60,60],w=6,f=1;for(d=6;0<=d;d--)t[d]&&(o[w]>=f&&(o[w]=0,h=1),0<h&&(o[d]++,h=0,w=d,f=1)),f*=g[d]}if(i)for(d=0;d<=6;d++)i&&o[d]?i--:i||(o[d]=0);return o}})}(jQuery);